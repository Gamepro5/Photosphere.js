'use strict';function isTouchDevice(){return"ontouchstart"in document.documentElement}function LoadPhotosphere(a,b){function c(){k.camera.aspect=k.rect.width/k.rect.height,k.camera.updateProjectionMatrix(),k.renderer.setPixelRatio(window.devicePixelRatio),k.rect=k.canvas.getBoundingClientRect(),k.renderer.setSize(k.rect.width,k.rect.height,!1)}function d(a,b){a.pointerDown=!0;!0===a.touchDevice&&(b.target===a.canvas?(a.pointerDown=!0,a.stopPan=!0,j&&j===a.canvas||(a.camera.fov=50,a.camera.updateProjectionMatrix(),j=a.canvas),a.camera.rotation.x>Math.PI/2?a.camera.rotation.x=Math.PI/2:a.camera.rotation.x<-Math.PI/2&&(a.camera.rotation.x=-Math.PI/2)):(a.pointerDown=!1,a.stopPan=!1,j=void 0))}function e(a,b){!0===a.touchDevice?a.pointerDown&&(a.pointerMoveX=b.movementX,a.pointerMoveY=b.movementY,l=(void 0!==b.movementX||0!==b.movementX)&&(void 0!==b.movementY||0!==b.movementY)):(a.pointerMoveX=b.movementX,a.pointerMoveY=b.movementY,l=(void 0!==b.movementX||0!==b.movementX)&&(void 0!==b.movementY||0!==b.movementY))}function f(a){a.pointerDown=!1}function g(a,b){switch(b.key){case"+":a.plusPressed=!0;break;case"_":a.underscorePressed=!0;break;case")":a.closeingParenthesePressed=!0;}}function h(a,b){switch(b.key){case"+":case"=":a.plusPressed=!1;break;case"_":case"-":a.underscorePressed=!1;break;case")":case"0":a.closeingParenthesePressed=!1;}}function i(){u||(r=window.requestAnimationFrame(i),k.touchDevice?k.stopPan?l&&(k.camera.rotation.y+=k.pointerMoveX/250,k.camera.rotation.x+=k.pointerMoveY/250,k.camera.rotation.x>Math.PI/2?k.camera.rotation.x=Math.PI/2:k.camera.rotation.x<-Math.PI/2&&(k.camera.rotation.x=-Math.PI/2),l=!1):(k.camera.rotation.x+=.01,k.camera.rotation.y+=.01,1>=k.camera.fov?(k.camera.fov=1,k.camera.updateProjectionMatrix(),s=1):179<=k.camera.fov&&(k.camera.fov=179,k.camera.updateProjectionMatrix(),s=-1),k.camera.fov+=s,k.camera.updateProjectionMatrix()):document.pointerLockElement&&document.pointerLockElement===k.canvas?(l&&(k.camera.rotation.y-=k.pointerMoveX/700,k.camera.rotation.x-=k.pointerMoveY/700,k.camera.rotation.x>Math.PI/2?k.camera.rotation.x=Math.PI/2:k.camera.rotation.x<-Math.PI/2&&(k.camera.rotation.x=-Math.PI/2),l=!1),k.plusPressed&&(0===k.camera.fov?(k.camera.fov=1,k.camera.updateProjectionMatrix()):1<k.camera.fov&&(k.camera.fov-=1,k.camera.updateProjectionMatrix())),k.underscorePressed&&(180===k.camera.fov?(k.camera.fov=179,k.camera.updateProjectionMatrix()):178>k.camera.fov&&(k.camera.fov+=1,k.camera.updateProjectionMatrix())),k.closeingParenthesePressed&&(k.camera.fov=50,k.camera.updateProjectionMatrix())):(k.camera.rotation.x+=.01,k.camera.rotation.y+=.01,1>=k.camera.fov?(k.camera.fov=1,k.camera.updateProjectionMatrix(),s=1):179<=k.camera.fov&&(k.camera.fov=179,k.camera.updateProjectionMatrix(),s=-1),k.camera.fov+=s,k.camera.updateProjectionMatrix()),k.renderer.render(k.scene,k.camera))}this.canvas=document.querySelector("#"+b),this.canvas.style.touchAction="none",this.renderer=new THREE.WebGLRenderer({canvas:this.canvas}),this.renderer.setPixelRatio(window.devicePixelRatio),this.rect=this.canvas.getBoundingClientRect(),this.renderer.setSize(this.rect.width,this.rect.height,!1),this.scene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(50,this.rect.width/this.rect.height,1,1100),this.scene.add(this.camera),this.camera.rotation.order="YXZ",this.geometry=new THREE.SphereBufferGeometry(500,60,60),this.geometry.position=new THREE.Vector3(0,0,0),this.geometry.scale(-1,1,1),this.texture=new THREE.TextureLoader().load(a),this.material=new THREE.MeshBasicMaterial({map:this.texture}),this.mesh=new THREE.Mesh(this.geometry,this.material),this.scene.add(this.mesh),this.stopPan=!1;let j,k=this;this.touchDevice=!!isTouchDevice();window.addEventListener("resize",c,!1);c();let l=!1;this.pointerMoveX=0,this.pointerMoveY=0;const m=a=>{d(this,a)};document.addEventListener("pointerdown",m);const n=a=>{e(this,a)};document.addEventListener("pointermove",n);const o=a=>{f(this,a)};document.addEventListener("pointerup",o);const p=a=>{g(this,a)};document.addEventListener("keydown",p);const q=a=>{h(this,a)};document.addEventListener("keyup",q),this.canvas.onclick=()=>{!1===this.touchDevice&&(document.pointerLockElement&&document.pointerLockElement===this.canvas||(this.camera.fov=50,this.camera.updateProjectionMatrix()),this.canvas.requestPointerLock(),this.camera.rotation.x>Math.PI/2?this.camera.rotation.x=Math.PI/2:this.camera.rotation.x<-Math.PI/2&&(this.camera.rotation.x=-Math.PI/2))};let r,s=1,t=!1,u=!1;window.requestAnimationFrame(i),this.terminate=function(){u=!0,k.renderer.forceContextLoss(),k.renderer.getContext().getExtension("WEBGL_lose_context").loseContext(),document.removeEventListener("pointerdown",m),document.removeEventListener("pointermove",n),document.removeEventListener("pointerup",o),document.removeEventListener("keydown",p),document.removeEventListener("keyup",q),k.renderer.clear(!0,!0,!0),k.renderer.dispose(),k.geometry.dispose(),k.texture.dispose(),k.material.dispose(),k.canvas.onclick=void 0,t=!0}}
